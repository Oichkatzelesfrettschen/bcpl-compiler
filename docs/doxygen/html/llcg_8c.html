<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BCPL Compiler: src/llcg.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">BCPL Compiler<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">A complete BCPL compiler implementation with runtime system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">llcg.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Experimental LLVM IR backend for the BCPL compiler.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;llvm-c/Core.h&gt;</code><br />
<code>#include &lt;llvm-c/Target.h&gt;</code><br />
<code>#include &lt;llvm-c/TargetMachine.h&gt;</code><br />
<code>#include &lt;llvm-c/Analysis.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div>
<p><a href="llcg_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a101753194b45f104fb9e2448e38ad450" id="r_a101753194b45f104fb9e2448e38ad450"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a101753194b45f104fb9e2448e38ad450">finish_module</a> (void)</td></tr>
<tr class="memdesc:a101753194b45f104fb9e2448e38ad450"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the LLVM module and compilation context.  <br /></td></tr>
<tr class="memitem:a14583798bbd37423c4446d982bbc3023" id="r_a14583798bbd37423c4446d982bbc3023"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14583798bbd37423c4446d982bbc3023">translate</a> (FILE *in)</td></tr>
<tr class="memdesc:a14583798bbd37423c4446d982bbc3023"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate OCODE instructions to LLVM IR.  <br /></td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe" id="r_a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="memdesc:a840291bc02cba5474a4cb46a9b9566fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main entry point for the LLVM code generator.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a88d6d140a9c999eadfafaee19b645eae" id="r_a88d6d140a9c999eadfafaee19b645eae"><td class="memItemLeft" align="right" valign="top">static LLVMModuleRef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88d6d140a9c999eadfafaee19b645eae">module</a></td></tr>
<tr class="memdesc:a88d6d140a9c999eadfafaee19b645eae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global LLVM context and code generation state.  <br /></td></tr>
<tr class="memitem:a0c253a2247001b0ef27db5217e9caa2d" id="r_a0c253a2247001b0ef27db5217e9caa2d"><td class="memItemLeft" align="right" valign="top">static LLVMBuilderRef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c253a2247001b0ef27db5217e9caa2d">builder</a></td></tr>
<tr class="memdesc:a0c253a2247001b0ef27db5217e9caa2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">LLVM IR builder for instruction generation.  <br /></td></tr>
<tr class="memitem:a706053bdc06a19bbc4961b94f60d9328" id="r_a706053bdc06a19bbc4961b94f60d9328"><td class="memItemLeft" align="right" valign="top">static LLVMValueRef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a706053bdc06a19bbc4961b94f60d9328">func</a></td></tr>
<tr class="memdesc:a706053bdc06a19bbc4961b94f60d9328"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current function being generated.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Experimental LLVM IR backend for the BCPL compiler. </p>
<dl class="section author"><dt>Author</dt><dd>BCPL Compiler Team </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2012 Robert Nordier. All rights reserved.</dd></dl>
<p>This file implements an experimental backend that generates LLVM IR (Intermediate Representation) from OCODE. This backend is a proof-of-concept demonstrating how the BCPL compiler can target modern compiler infrastructures.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Current Status</h2>
<p>This is an intentionally incomplete implementation that serves as:</p><ul>
<li>A demonstration of the compiler's extensible backend architecture</li>
<li>A foundation for future LLVM-based optimizations</li>
<li>An example of integrating with the LLVM-C API</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
Architecture</h2>
<p>The backend processes OCODE instructions and translates them to LLVM IR, which can then be optimized by LLVM's optimization passes and compiled to native code for any target supported by LLVM.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
Limitations</h2>
<p>Currently only a minimal subset of OCODE is supported. A complete implementation would require:</p><ul>
<li>Full OCODE instruction coverage</li>
<li>BCPL runtime system integration</li>
<li>Proper memory management</li>
<li>Exception handling</li>
<li>Debugging information generation </li>
</ul>

<p class="definition">Definition in file <a class="el" href="llcg_8c_source.html">llcg.c</a>.</p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a101753194b45f104fb9e2448e38ad450" name="a101753194b45f104fb9e2448e38ad450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a101753194b45f104fb9e2448e38ad450">&#9670;&#160;</a></span>finish_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void finish_module </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the LLVM module and compilation context. </p>
<p>Sets up the LLVM environment, creates a module, and initializes the IR builder. This function must be called before any code generation can occur.</p>
<p>The initialization process:</p><ol type="1">
<li>Initializes all LLVM targets and subsystems</li>
<li>Creates a new LLVM module static void init_module(void) { LLVMInitializeAllTargets(); LLVMInitializeAllTargetMCs(); LLVMInitializeAllAsmPrinters(); LLVMInitializeAllAsmParsers(); module = LLVMModuleCreateWithName("bcpl_module"); LLVMTypeRef fn_type = LLVMFunctionType(LLVMInt32Type(), NULL, 0, 0); func = LLVMAddFunction(module, "main", fn_type); LLVMBasicBlockRef entry = LLVMAppendBasicBlock(func, "entry"); builder = LLVMCreateBuilder(); LLVMPositionBuilderAtEnd(builder, entry); }</li>
</ol>
<p>/**</p>
<p>Finalize the LLVM module and clean up resources</p>
<p>Completes the current function with a return statement and cleans up the IR builder. This function should be called after all OCODE has been processed. </p>

<p class="definition">Definition at line <a class="el" href="llcg_8c_source.html#l00081">81</a> of file <a class="el" href="llcg_8c_source.html">llcg.c</a>.</p>

</div>
</div>
<a id="a840291bc02cba5474a4cb46a9b9566fe" name="a840291bc02cba5474a4cb46a9b9566fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840291bc02cba5474a4cb46a9b9566fe">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main entry point for the LLVM code generator. </p>
<dl class="section return"><dt>Returns</dt><dd>Exit status (0 for success)</dd></dl>
<p>This function orchestrates the LLVM IR generation process:</p><ol type="1">
<li>Initializes the LLVM module and context</li>
<li>Translates OCODE from stdin to LLVM IR</li>
<li>Finalizes the module</li>
<li>Outputs the generated IR to stdout</li>
<li>Cleans up resources </li>
</ol>

<p class="definition">Definition at line <a class="el" href="llcg_8c_source.html#l00128">128</a> of file <a class="el" href="llcg_8c_source.html">llcg.c</a>.</p>

</div>
</div>
<a id="a14583798bbd37423c4446d982bbc3023" name="a14583798bbd37423c4446d982bbc3023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14583798bbd37423c4446d982bbc3023">&#9670;&#160;</a></span>translate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void translate </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>in</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Translate OCODE instructions to LLVM IR. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Input stream containing OCODE instructions</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads OCODE instructions from the input stream and generates corresponding LLVM IR. Currently only a minimal subset of operations is implemented as a proof of concept.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Implementation Notes</h2>
<ul>
<li>A complete implementation would maintain a value stack</li>
<li>Each OCODE operation would manipulate LLVM Values</li>
<li>Control flow would be handled with LLVM BasicBlocks</li>
<li><p class="startli">Memory operations would use LLVM's memory model</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo</a></b></dt><dd><p class="startdd">Implement remaining OCODE operations </p>
<p class="interdd">Add proper error handling </p>
<p class="enddd">Implement BCPL calling conventions </p>
</dd></dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="llcg_8c_source.html#l00105">105</a> of file <a class="el" href="llcg_8c_source.html">llcg.c</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a0c253a2247001b0ef27db5217e9caa2d" name="a0c253a2247001b0ef27db5217e9caa2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c253a2247001b0ef27db5217e9caa2d">&#9670;&#160;</a></span>builder</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LLVMBuilderRef builder</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>LLVM IR builder for instruction generation. </p>

<p class="definition">Definition at line <a class="el" href="llcg_8c_source.html#l00047">47</a> of file <a class="el" href="llcg_8c_source.html">llcg.c</a>.</p>

</div>
</div>
<a id="a706053bdc06a19bbc4961b94f60d9328" name="a706053bdc06a19bbc4961b94f60d9328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a706053bdc06a19bbc4961b94f60d9328">&#9670;&#160;</a></span>func</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LLVMValueRef func</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current function being generated. </p>

<p class="definition">Definition at line <a class="el" href="llcg_8c_source.html#l00048">48</a> of file <a class="el" href="llcg_8c_source.html">llcg.c</a>.</p>

</div>
</div>
<a id="a88d6d140a9c999eadfafaee19b645eae" name="a88d6d140a9c999eadfafaee19b645eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d6d140a9c999eadfafaee19b645eae">&#9670;&#160;</a></span>module</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LLVMModuleRef module</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global LLVM context and code generation state. </p>
<p>These variables maintain the LLVM compilation context throughout the code generation process. LLVM module containing generated IR </p>

<p class="definition">Definition at line <a class="el" href="llcg_8c_source.html#l00046">46</a> of file <a class="el" href="llcg_8c_source.html">llcg.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
